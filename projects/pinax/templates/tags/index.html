{% extends "site_base.html" %}

{% load i18n %}
{% load gravatar %}
{% load humanize %}
{% load pagination_tags %}
{% load captureas_tag %}
{% load tagging_tags %}
{% load wiki %}
{% load markup %}
{% load switchcase %}
{% load restructuredtext %}

{% block head_title %}{% blocktrans %}Tags{% endblocktrans %}{% endblock %}

{% block body %}
    <p><span class="warning">Note</span>: this is an <b>experimental</b> feature that is subject to massive change at any time.</p>
    
    <h1>{% trans "All Photos Matching " %}<i>"{{ tag }}"</i></h1>
    
    {% if phototags %}
        {% for photo in phototags %}
            <div class="clearfix">
                <div class="gallery-photo-thumb">
                    <a href="/photos/details/{{ photo.id }}/"><img src="/site_media/{{ photo.get_thumbnail_url }}" alt="{{ photo.title }}"/></a><br />
                    from <a href="{% url profiles.views.profile photo.member.username %}">{{ photo.member.username }}</a><br />
                    Viewed {{ photo.view_count }} Times
                </div>
            </div>
        {% endfor %}
    {% else %}
        No photos matching tag.
    {% endif %}

    <h1>{% trans "All Blog Posts Matching " %}<i>"{{ tag }}"</i></h1>
    
    {% if alltags %}
        <p>{% trans "These are blog posts from everyone:" %}</p>
            {% for blogs in alltags %}
                <div class="blog-post clearfix">
                    <h2><a href="{{ blogs.get_absolute_url }}">{{ blogs.title }}</a></h2>
                    <div class="blog-post-tease">
                        {% with blogs.tease as body %}
                            {% switch blogs.markup %}
                                {% case 'rst' %} {{ body|restructuredtext|wikiwords|safe }} {% endcase %}
                                {% case 'mrk' %} {{ body|force_escape|markdown|wikiwords }} {% endcase %}
                                {% case 'txl' %} {{ body|force_escape|textile|wikiwords }} {% endcase %}
                                {% case '' %} {{ body|force_escape|wikiwords|linebreaks|safe }} {% endcase %}
                            {% endswitch %}
                        {% endwith %}
                    </div>
                    <div class="blog-post-meta">
                        {% gravatar blogs.author 40 %}
                        <p><b>Posted:</b><br /><a href="{% url profiles.views.profile blogs.author.username %}">{{ blogs.author.username }}</a> on {{ blogs.publish|date }}</p>
                        <div class="blog-tags">
                            <p><b>Tags:</b><br /> 
                            {% tags_for_object blogs as tags %}
                            {% for tag in tags %}
                                <a href="/tags/{{ tag }}">{{ tag }}</a>
                            {% endfor %}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
    
    {% else %}
        No blog posts matching tag.
    {% endif %}
    
    
{% endblock %}